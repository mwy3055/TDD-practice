# Chapter 04. TDD, 기능 명세, 설계
## 기능 명세
기능 명세서는 다양한 형식으로 작성할 수 있다. PPT로 보여줄 수도 있고, 문장으로 작성할 수도 있고, Github Issue로 정리할 수도 있다.
어쨌든 기능을 구현하려면 기능을 크게 **입력과 결과** 두 가지로 나눠야 한다. 예를 들어 로그인 기능은 다음과 같이 나눌 수 있다.
* 입력: 아이디와 비밀번호
* 결과: 로그인 성공 또는 실패

3장에서 작성한 `ExpiryDateCalculator`의 입력과 출력은 다음과 같다.
* 입력: 구독 시작일, 납부일, 납부액
* 결과: 구독 만료일

실행 결과에는 데이터를 변경하는 것도 포함된다. 예를 들어 DB에 데이터를 추가하는 데 성공했다는 결과를 얻었다고 치자. 그러면 실제로 DB에 그 데이터가 추가되었을 것이다.
이런 경우엔 결과값을 통해 데이터가 올바르게 추가되었는지 확인할 수 있어야 한다.

소프트웨어 설계는 기능 명세로부터 시작한다. 명세를 어떻게 작성하건간에 중요한 점은 사용자가 기대하는 기능의 목록을 만들고, 각 기능의 입력과 출력을 명확히 정하는 것이다.
명세가 완전히 구체화되었다면 코드를 올바르게 작성하기만 하면 된다. **코드는 기능 명세의 부산물이다.**

# TDD가 설계를 만든다
TDD는 테스트 코드로부터 시작된다. 테스트 코드를 작성하려면...
* 테스트할 기능을 실행하고
* 기능의 출력값을 검증할 수 있어야 한다.

기능을 실행하려면 객체 또는 메서드를 작성해야 하고, 그러려면 그 객체나 메서드의 **이름**과 **매개변수**, **반환 값**을 정해야 한다. 이게 바로 설계 아닌가?
테스트 코드를 작성하기 위해 고민하는 것들이 결국 소프트웨어 설계의 가장 핵심적인 부분이라는 것이다. 

## 필요한 만큼 설계한다
TDD는 테스트를 통과할 만큼만 코드를 작성한다. 마찬가지로 미리 설계를 유연하게 만들 필요도 없다. 테스트를 추가하면서 그때그때 필요한 만큼 설계를 변경한다.

실행 결과를 설계할 때도, 미리 `Exception`을 정의하지 않는다. 테스트를 작성하는 과정에서 필요한 시점에 `Exception`을 정의한다.
이렇게 설계를 그때그때 수정함으로써 설계가 불필요하게 복잡해지는 일을 막을 수 있다.

설계는 항상 유연하게 변경될 수 있어야 한다. 아무리 철저한 계획이라도 개발이 끝날 때까지 바뀌지 않는 경우는 **없기** 때문이다. 
TDD는 미리 코드를 만들지 않으므로 불필요한 설계를 덜 만들게 된다.

# 명세서 구체화
테스트 코드를 작성하기 위해 개발자는 기능 명세서를 정리해야 한다. 보통 명세서는 기힉자가 작성한 스토리보드나 와이어프레임으로 주어지는데,
이런 문서는 사용자의 요구를 정리하기에는 좋아도 개발자에게는 모호한 정보의 집합으로 여겨지기 일쑤다.

모호함을 해결하려면 기획자와 소통하여 기능을 명확하게 한다. 이때 구체적인 테스트 케이스의 결과를 물어보면 좋다.
이렇게 작성한 테스트 코드는 즉시 실행할 수 있기 때문에, 기능을 이해하고 유지보수하는데 큰 도움을 준다. 

> 개발자는 코드가 극단적인 상황에서도 동작할 수 있도록 철저히 대비해야 한다. 기획자와 대화하라!