# 테스트 코드 작성 순서

## 테스트 - 구현 - 확인

테스트 코드는 다음의 규칙에 따라 작성한다.

* 쉬운 케이스에서 어려운 케이스로 진행
* 예외적인 케이스에서 일반적인 케이스로 진행

## 어려운 케이스부터 작성하면 안 되는 이유

처음부터 어려운 케이스를 추가하면, 나중에 쉬운 케이스를 추가하는 과정에서 구현해야 할 코드가 많아진다.

## 쉬운 테스트부터 시작하기

보통 모든 조건을 만족하거나 모든 조건을 만족하지 않는 테스트부터 시작한다. 그 후에 만족하는 조건을 조금씩 줄여 나가면서 테스트 커버리지를 넓히면 된다.

## 예외적인 케이스를 먼저 테스트해야 하는 이유

다양한 예외 상황은 복잡한 조건문을 동반한다. 예외가 없던 코드에 예외를 반영하는 과정에서 코드가 복잡해지기 쉽다. 처음에 예외 상황을 반영해 두면 나중에 일반적인 상황을 반영하기 쉬워진다.

예외 상황을 먼저 반영하면 실제 코드에서 `Exception`이 발생하는 빈도를 줄일 수 있다.

## 한 번에 얼마나?

그래서 한 번에 얼마만큼 코드를 작성해야 하는가? 다음의 순서에 맞게 작성해 보자.

1. 상수를 반환
2. 값을 비교하여 상수를 반환
3. 테스트를 추가하면서 반환하는 값을 일반화

항상 테스트 - 구현 - 확인이라는 리듬을 잘 지키자. 처음에는 지루하게 느껴질 수도 있지만, 처음에 잘 연습해 둬야 나중에 상황에 맞게 구현 속도를 조절할 수 있게 된다.

## 테스트할 목록 정리하기
테스트 케이스를 미리 생각해 놓으면 좋다. 그 중 구현하기 쉽거나 예외적인 테스트부터 하나씩 작성하면 된다.
테스트 과정에서 새로운 케이스를 발견했다면 즉시 목록에 추가하자. 처음부터 모든 케이스를 생각할 수는 없기 때문이다.

테스트 코드를 만들고, 실패하고, 고치고, 테스트를 통과하는 과정을 계속 반복해야 한다. 짧은 과정을 여러 번 반복한다고 생각하면 좋다. 

## 리팩토링하자!

테스트를 모두 작성한 후에는 코드를 리팩토링한다. 대표적으로 중복된 코드를 제거하고, 변수의 가독성을 높이는 것이 있다. 물론 테스트 코드 자체도 리팩토링해야 한다.

너무 큰 리팩토링은 테스트를 모두 작성한 후에 진행하자. 리팩토링에 파묻히면 본래의 목적(테스트)을 잃을 수 있기 때문이다.

## 연습: `ExpiryDateCalculator` 테스트하기

구독 서비스의 만료일을 계산하는 `ExpiryDateCalculator`를 테스트하는 코드를 작성해 보자. 위에서 설명한 내용을 고려하여 작성한다. 